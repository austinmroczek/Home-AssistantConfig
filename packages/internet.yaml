# control the internet from Home Assistant

# adapted from https://medium.com/@arturlr/using-iot-button-to-control-my-kids-internet-usage-5bd825c1da76


##### setup the router #####
# # install mosquitto MQTT broker
# # help from https://www.onetransistor.eu/2019/05/mosquitto-mqtt-on-openwrt-router.html
# opkg install mosquitto mosquitto-client-nossl
# # edit /etc/mosquitto/mosquitto.conf as needed
# # generally follow directions of adapted from https://medium.com/@arturlr/using-iot-button-to-control-my-kids-internet-usage-5bd825c1da76
# # ...but instead of connecting to Amazon we're using the local server

##### setup the machine hosting home assistant (this one) #####

# # get the mosquitto clients
# apt install mosquitto-clients


##### set up switches #####
switch:
  - platform: mqtt
    unique_id: melanie_internet
    name: Melanie Internet
    state_topic: "ha/internet/kid_computer"
    command_topic: "ha/internet/kid_computer"
#    availability_topic: "ha/internet/kid_computer/available"
#    payload_on: "on"
#    payload_off: "off"
#    state_on: "on"
#    state_off: "off"
    retain: true

  - platform: mqtt

    unique_id: ipad_internet
    name: iPad Internet
    state_topic: "ha/internet/ipad"
    command_topic: "ha/internet/ipad"
 #   availability_topic: "ha/internet/ipad/available"
 #   payload_on: on
 #   payload_off: off
 #   state_on: on
 #   state_off: off
    retain: true


group:
  internet:
    name: Internet
    entities:
      - switch.melanie_internet
      - switch.ipad_internet

